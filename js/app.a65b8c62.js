(function(t){function e(e){for(var o,s,a=e[0],c=e[1],u=e[2],d=0,h=[];d<a.length;d++)s=a[d],Object.prototype.hasOwnProperty.call(r,s)&&r[s]&&h.push(r[s][0]),r[s]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(t[o]=c[o]);l&&l(e);while(h.length)h.shift()();return i.push.apply(i,u||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],o=!0,a=1;a<n.length;a++){var c=n[a];0!==r[c]&&(o=!1)}o&&(i.splice(e--,1),t=s(s.s=n[0]))}return t}var o={},r={app:0},i=[];function s(e){if(o[e])return o[e].exports;var n=o[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=t,s.c=o,s.d=function(t,e,n){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)s.d(n,o,function(e){return t[e]}.bind(null,o));return n},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/signal-flow-graph-solver/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],c=a.push.bind(a);a.push=e,a=a.slice();for(var u=0;u<a.length;u++)e(a[u]);var l=c;i.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"034f":function(t,e,n){"use strict";n("85ec")},"0d1f":function(t,e,n){},"184d":function(t,e,n){},2038:function(t,e,n){"use strict";n("dd77")},"2b45":function(t,e,n){"use strict";n("ec4c")},5355:function(t,e,n){"use strict";n("c82a")},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var o=n("2b0e"),r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("div",{attrs:{id:"sketching-area"}},[n("appHeader"),n("errorMsg"),n("board")],1),n("solutionArea")],1)},i=[],s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"header"}},[n("clearAll"),n("insert"),n("solve")],1)},a=[],c=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"insert"}},[o("div",{staticClass:"insert-btn",attrs:{id:"node-btn"},on:{click:function(e){return t.addNode()}}},[t._m(0),o("div",{staticClass:"label"},[t._v("Node")])]),o("div",{staticClass:"action-btn",attrs:{id:"cursor-btn"},on:{click:function(e){return t.selectCursor()}}},[o("img",{attrs:{src:n("885c"),width:"17px"}}),o("div",{staticClass:"action-label"},[t._v("Select")])]),o("div",{staticClass:"action-btn",attrs:{id:"delete-btn"},on:{click:function(e){return t.deleteComponent()}}},[o("img",{attrs:{src:n("fc48"),width:"16px"}}),o("div",{staticClass:"action-label"},[t._v("Delete")])])])},u=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"icon",attrs:{id:"node"}},[n("div",{staticClass:"icon-label"},[t._v("N")])])}],l=n("5530"),d=n("2f62"),h={name:"insert",data:function(){return{components:{node:"machine"}}},computed:Object(d["c"])(["getCurrentComponent","getCurrSelectedComponent"]),methods:Object(l["a"])(Object(l["a"])({},Object(d["b"])(["enableDrawingMode","disableDrawingMode","setCurrentComponent","resetCurrSelectedComponent"])),{},{addNode:function(){this.selectCursor(),this.enableDrawingMode()},selectCursor:function(){this.disableDrawingMode();var t=this.getCurrentComponent;null!=t&&(t.remove(),this.setCurrentComponent(null))},deleteComponent:function(){var t=this.getCurrSelectedComponent;null!=t&&t.remove(),this.resetCurrSelectedComponent()}})},m=h,f=(n("d004"),n("2877")),p=Object(f["a"])(m,c,u,!1,null,"6c315730",null),v=p.exports,g=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"solution"}},[n("div",{attrs:{id:"solve-btn"},on:{click:function(e){return t.triggerSolve()}}},[t._v("Solve")])])},C=[],b=n("b85c"),y=(n("d3b7"),n("ddb0"),n("cb29"),n("99af"),n("2909")),w=(n("13d5"),[]),P=[],_=[];function A(t){w.length=0,P.length=0,_=new Array(t.length).fill(!1);var e=0;return k(t,e),{paths:w,gains:P}}function k(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];if(_[e]=!0,n.push(e),e==t.length-1)w.push(Object(y["a"])(n)),P.push(Object(y["a"])(o).reduce((function(t,e){return t*e})));else for(var r=0;r<t.length;r++)_[r]||0==t[e][r]||(o.push(t[e][r]),k(t,r,n,o));n.pop(),o.length>0&&(o.pop(),_[e]=!1)}n("caad"),n("2532");function x(t){for(var e=[],n=[],o=[],r=[],i=0;i<t.length;i++)r.push(!1);for(var s=0;s<t.length;s++)0==r[s]&&O(t,s,o,r,e,n);var a={loops:e,gains:n};return a}function O(t,e,n,o,r,i){o[e]=!0,n.push(e);for(var s=0;s<t.length;s++)if(0!=t[e][s]){if(n.includes(s)){for(var a=[],c=1,u=n.indexOf(s);u<n.length;u++)a.push(n[u]);for(var l=0;l<a.length;l++)c*=t[a[l]][a[(l+1)%a.length]];a.push(s),S(a,c,r,i)}n.includes(s)||O(t,s,n,o,r,i)}n.pop()}function S(t,e,n,o){for(var r=!1,i=0;i<n.length;i++){if(t.length==n[i].length&&e==o[i]){var s=n[i].indexOf(t[0]);if(-1!=s){r=!0;for(var a=0;a<t.length-1;a++)if(t[a]!=n[i][(a+s)%(n[i].length-1)]){r=!1;break}}}if(r)return}n.push(t),o.push(e)}n("6062"),n("3ca3");function E(t,e){for(var n=t.paths,o=t.gains,r=e.loops,i=e.gains,s=n.length,a=M(r,i),c=j(n,r,i),u=0,l=0;l<s;l++)u+=o[l]*c[l];var d=1/a*u;return{transferFunction:d,deltas:c,systemDelta:a}}function M(t,e){for(var n=1,o=0,r=0;r<t.length;r++)o+=e[r];n-=o;var i=t.length,s=Object(y["a"])(t),a=Object(y["a"])(e),c=-1;while(i>0){c*=-1,i=0;for(var u=[],l=[],d=0;d<s.length;d++)for(var h=d+1;h<t.length;h++)N(s[d],t[h])&&(u.push(I(s[d],t[h])),l.push(a[d]*e[h]),i++,n+=c*a[d]*e[h]);s=[].concat(u),a=[].concat(l)}return n}function j(t,e,n){for(var o=[],r=[],i=[],s=0;s<t.length;s++){r=[],i=[];for(var a=0;a<e.length;a++)N(t[s],e[a])&&(r.push(e[a]),i.push(n[a]));o.push(M(r,i))}return o}function N(t,e){for(var n=0;n<t.length;n++)for(var o=0;o<e.length;o++)if(t[n]==e[o])return!1;return!0}function I(t,e){for(var n=new Set,o=0;o<t.length;o++)n.add(t[o]);for(var r=0;r<e.length;r++)n.add(e[r]);var i,s=[],a=Object(b["a"])(n);try{for(a.s();!(i=a.n()).done;){var c=i.value;s.push(c)}}catch(u){a.e(u)}finally{a.f()}return s}var L={name:"solve",data:function(){return{nodeNum:0}},computed:Object(d["c"])(["nodes","getErrorCard"]),methods:Object(l["a"])(Object(l["a"])({},Object(d["b"])(["setErrorMsg"])),{},{triggerSolve:function(){if(this.isValidGraph()){var t=this.getGraphInfo();this.nodeNum=t.length;var e=A(t),n=x(t),o=E(e,n);this.openSolutionArea(),this.showSolution(e,n,o),document.getElementById("board").style.pointerEvents="none"}},getGraphInfo:function(){var t,e=this.nodes.size,n=new Array(e),o=Object(b["a"])(this.nodes.values());try{for(o.s();!(t=o.n()).done;){var r=t.value;r.unselectSelf();var i,s=r.toConnectionPoint.outConnectors.values(),a=new Array(e).fill(0),c=0,u=Object(b["a"])(s);try{for(u.s();!(i=u.n()).done;){var l=i.value;c=l.to.isOutputNode?e-1:l.to.code,a[c]=l.gain}}catch(h){u.e(h)}finally{u.f()}var d=0;d=r.isInputNode?0:r.isOutputNode?e-1:r.code,n[d]=a}}catch(h){o.e(h)}finally{o.f()}return n},showSolution:function(t,e,n){document.getElementById("steps").innerHTML="",this.addTitle("Forward paths :");var o,r=1,i=Object(b["a"])(t.paths);try{for(i.s();!(o=i.n()).done;){var s=o.value;this.addPath(s,r++,t.gains[r-2])}}catch(p){i.e(p)}finally{i.f()}this.addTitle("Loops :");var a,c=1,u=Object(b["a"])(e.loops);try{for(u.s();!(a=u.n()).done;){var l=a.value;this.addLoop(l,c++,e.gains[c-2])}}catch(p){u.e(p)}finally{u.f()}this.addTitle("Transfer function :");var d,h=1,m=Object(b["a"])(n.deltas);try{for(m.s();!(d=m.n()).done;){var f=d.value;this.addDelta(f,h++)}}catch(p){m.e(p)}finally{m.f()}this.addDelta(n.systemDelta,h,!1),this.addFormula(n.transferFunction),this.RenderLatex(),this.unhighlightAll()},addTitle:function(t){var e=document.createElement("div");e.innerHTML="$$\\underline{\\text{".concat(t,"}}$$"),e.className="solve-title",document.getElementById("steps").appendChild(e)},addPath:function(t,e,n){var o=this,r=t.length,i=document.createElement("div"),s=document.createElement("div");s.innerHTML="$$P_".concat(e," :");for(var a=0;a<r-1;a++)s.innerHTML+="".concat(this._getNodeIndex(t[a])," \\xrightarrow{}");s.innerHTML+="".concat(this._getNodeIndex(t[r-1]),"$$"),s.className="path";var c=document.createElement("div");c.innerHTML="$$P_".concat(e," = ").concat(n,"$$"),c.className="gain",i.appendChild(s),i.appendChild(c),i.className="solution-info",i.onmouseover=function(){return o.highlightSequence(t)},i.onmouseleave=function(){return o.unhighlightAll()},document.getElementById("steps").appendChild(i)},addLoop:function(t,e,n){var o=this,r=t.length,i=document.createElement("div"),s=document.createElement("div");s.innerHTML="$$L_".concat(e,": ");for(var a=0;a<r-1;a++)s.innerHTML+="".concat(this._getNodeIndex(t[a])," \\xrightarrow{}");s.innerHTML+="".concat(this._getNodeIndex(t[r-1]),"$$"),s.className="loop";var c=document.createElement("div");c.innerHTML="$$L_".concat(e," = ").concat(n,"$$"),c.className="gain",i.appendChild(s),i.appendChild(c),i.className="solution-info",i.onmouseover=function(){return o.highlightSequence(t)},i.onmouseleave=function(){return o.unhighlightAll()},document.getElementById("steps").appendChild(i)},addDelta:function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=document.createElement("div");o.innerHTML=n?"$$\\Delta_".concat(e," = ").concat(t,"$$"):"$$\\Delta = ".concat(t,"$$"),o.className="solution-info",document.getElementById("steps").appendChild(o)},addFormula:function(t){var e=document.createElement("div");e.innerHTML="$$C(S) / R(S) = ".concat(t,"$$"),e.className="solution-info",document.getElementById("steps").appendChild(e)},_getNodeIndex:function(t){var e="";return e=0==t?"R":t==this.nodeNum-1?"C":t,e},openSolutionArea:function(){this.$root.$refs.solutionArea.open(),document.getElementById("board").style.transform="scale(0.5)",document.getElementById("board").style.left="-40%"},RenderLatex:function(){window.MathJax&&window.MathJax.Hub.Queue(["Typeset",window.MathJax.Hub])},isValidGraph:function(){var t,e=Object(b["a"])(this.nodes.values());try{for(e.s();!(t=e.n()).done;){var n=t.value;if(!n.isInputNode&&0==n.fromConnectionPoint.inConnectors.size)return this.setErrorMsg("Node ".concat(n.code," has no input branches")),this.getErrorCard.showErrorMsg(),!1;if(!n.isOutputNode&&0==n.toConnectionPoint.outConnectors.size)return this.setErrorMsg("Node ".concat(n.code," has no output brances")),this.getErrorCard.showErrorMsg(),!1}}catch(o){e.e(o)}finally{e.f()}return!0},highlightSequence:function(t){for(var e=0,n=0;n<t.length;n++){e=t[n];var o,r=Object(b["a"])(this.nodes.values());try{for(r.s();!(o=r.n()).done;){var i=o.value;if(this._getNodeCode(i)==e){i.highlightSelf(),i.fromConnectionPoint.highlightSelf(),i.toConnectionPoint.highlightSelf();var s,a=Object(b["a"])(i.toConnectionPoint.outConnectors.values());try{for(a.s();!(s=a.n()).done;){var c=s.value;n+1<t.length&&this._getNodeCode(c.to)==t[n+1]&&c.highlightSelf()}}catch(u){a.e(u)}finally{a.f()}}}}catch(u){r.e(u)}finally{r.f()}}},_getNodeCode:function(t){var e=0;return e=t.isInputNode?0:t.isOutputNode?this.nodeNum-1:t.code,e},unhighlightAll:function(){var t,e=Object(b["a"])(this.nodes.values());try{for(e.s();!(t=e.n()).done;){var n=t.value;n.unselectSelf(),n.fromConnectionPoint.unselectSelf(),n.toConnectionPoint.unselectSelf();var o,r=Object(b["a"])(n.toConnectionPoint.outConnectors.values());try{for(r.s();!(o=r.n()).done;){var i=o.value;i.unselectSelf()}}catch(s){r.e(s)}finally{r.f()}}}catch(s){e.e(s)}finally{e.f()}}})},D=L,$=(n("2038"),Object(f["a"])(D,g,C,!1,null,"5bf00ea5",null)),B=$.exports,T=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"clear-all"}},[n("div",{attrs:{id:"delete-all-btn"},on:{click:function(e){return t.clearAll()}}},[t._v("clear all")])])},H=[],F=n("d4ec"),W=n("bee2"),G=n("ade3"),R=n("cffa"),Y=(n("4ec9"),{drawingMode:!1,currentComponenet:null,nodes:new Map}),X={isDrawing:function(t){return t.drawingMode},nodes:function(t){return t.nodes},getCurrentComponent:function(t){return t.currentComponenet}},z={enableDrawingMode:function(t){var e=t.commit;return e("setDrawingMode",!0)},disableDrawingMode:function(t){var e=t.commit;return e("setDrawingMode",!1)},setCurrentComponent:function(t,e){var n=t.commit;return n("changeCurrentComponent",e)},pushNewNode:function(t,e){var n=t.commit;n("pushNode",e);var o,r=Object(b["a"])(Y.nodes.values());try{for(r.s();!(o=r.n()).done;){var i=o.value;i.resetColor()}}catch(s){r.e(s)}finally{r.f()}},clearAllNodess:function(t){var e=t.commit;return e("clearNodes")}},J={setDrawingMode:function(t,e){return t.drawingMode=e},changeCurrentComponent:function(t,e){return t.currentComponenet=e},pushNode:function(t,e){return t.nodes.set(e.code,e)},clearNodes:function(t){return t.nodes.length=0}},U={state:Y,getters:X,actions:z,mutations:J},V={boardMouseDown:!1,fromComponent:null,toComponent:null,currSelectedComponent:null,errorMsg:"",errorCard:null},q={isBoardMouseDown:function(t){return t.boardMouseDown},getFromComponent:function(t){return t.fromComponent},getToComponent:function(t){return t.toComponent},getCurrSelectedComponent:function(t){return t.currSelectedComponent},getErrorMsg:function(t){return t.errorMsg},getErrorCard:function(t){return t.errorCard}},Q={setBoardMouseDown:function(t,e){var n=t.commit;return n("changeBoardMouseDown",e)},setFromComponent:function(t,e){var n=t.commit;return n("changeFromComponent",e)},setToComponent:function(t,e){var n=t.commit;null!=V.fromComponent&&n("changeToComponent",e)},setErrorMsg:function(t,e){var n=t.commit;return n("changeErrorMsg",e)},setErrorCard:function(t,e){var n=t.commit;return n("changeErrorCard",e)},resetFromComponent:function(t){var e=t.commit;return e("changeFromComponent",null)},resetToComponent:function(t){var e=t.commit;return e("changeToComponent",null)},resetCurrSelectedComponent:function(t){var e=t.commit;return e("setCurrSelectedComponent",null)}},K={changeBoardMouseDown:function(t,e){return t.boardMouseDown=e},changeFromComponent:function(t,e){return t.fromComponent=e},changeToComponent:function(t,e){return t.toComponent=e},setCurrSelectedComponent:function(t,e){return t.currSelectedComponent=e},changeErrorCard:function(t,e){return t.errorCard=e},changeErrorMsg:function(t,e){return t.errorMsg=e}},Z={state:V,getters:q,actions:Q,mutations:K};o["a"].use(d["a"]);var tt=new d["a"].Store({modules:{construction:U,connection:Z}}),et=n("262e"),nt=n("2caf"),ot=function(){function t(e){Object(F["a"])(this,t),this.componentAttached=e,this.connectionPoint=null,this.connectionPointWrapper=null}return Object(W["a"])(t,[{key:"removeSelf",value:function(){this.connectionPoint.remove(),this.connectionPointWrapper.remove()}},{key:"_createConnectionPoint",value:function(t){var e=document.getElementById("board"),n="http://www.w3.org/2000/svg",o=document.createElementNS(n,"circle");R["a"].set(o,{attr:{cx:t,cy:this.componentAttached.center.y,r:6,fill:"black","fill-opacity":1,stroke:"none","stroke-width":0},css:{userSelect:"none"}}),e.appendChild(o),this.connectionPoint=o}},{key:"_createConnectionWrapper",value:function(t){var e=document.getElementById("board"),n="http://www.w3.org/2000/svg",o=document.createElementNS(n,"circle");R["a"].set(o,{attr:{cx:t,cy:this.componentAttached.center.y,r:12,fill:"transparent","fill-opacity":0,stroke:"none","stroke-width":0},css:{userSelect:"none"}}),e.appendChild(o),this.connectionPointWrapper=o}},{key:"highlightSelf",value:function(){this.connectionPoint.setAttribute("fill","#E74C3C")}},{key:"unselectSelf",value:function(){this.connectionPoint.setAttribute("fill","black")}}]),t}(),rt=function(t){Object(et["a"])(n,t);var e=Object(nt["a"])(n);function n(t){var o;return Object(F["a"])(this,n),o=e.call(this,t),o.fromComponents=new Map,o.inConnectors=new Map,o._createConnectionWrapper(t.center.x-t.width/2*16),o._createConnectionPoint(t.center.x-t.width/2*16),o._addActions(),o}return Object(W["a"])(n,[{key:"deleteAll",value:function(){this.removeSelf();var t,e=Object(b["a"])(this.inConnectors.values());try{for(e.s();!(t=e.n()).done;){var n=t.value;n.removeSelf()}}catch(o){e.e(o)}finally{e.f()}this.inConnectors.clear()}},{key:"updatePos",value:function(){this.connectionPoint.setAttribute("cx",this.componentAttached.center.x-this.componentAttached.width/2*16),this.connectionPoint.setAttribute("cy",this.componentAttached.center.y),this.connectionPointWrapper.setAttribute("cx",this.componentAttached.center.x-this.componentAttached.width/2*16),this.connectionPointWrapper.setAttribute("cy",this.componentAttached.center.y)}},{key:"_addActions",value:function(){var t=this;this.connectionPoint.onmouseover=function(){t._setAsToComponent()},this.connectionPointWrapper.onmouseleave=function(){t._removeAsToComponent()},this.connectionPointWrapper.onmouseover=function(){t._setAsToComponent()}}},{key:"reset",value:function(){this.removeSelf(),this._createConnectionWrapper(this.componentAttached.center.y-this.componentAttached.width/2*16),this._createConnectionPoint(this.componentAttached.center.x-this.componentAttached.width/2*16),this._addActions()}},{key:"_setAsToComponent",value:function(){tt.dispatch("setToComponent",this.componentAttached)}},{key:"_removeAsToComponent",value:function(){tt.dispatch("resetToComponent")}},{key:"addFromComponent",value:function(t){this.fromComponents.set(t.code,t)}},{key:"addInConnector",value:function(t){this.inConnectors.set(t.code,t)}},{key:"hasFromComponent",value:function(t){return this.fromComponents.has(t)}}]),n}(ot),it=function(){function t(e){Object(F["a"])(this,t),this.code=this._generateCode(),this.gain=1,this.mouseDown=!1,this.reversed=!1,this.branch=null,this.arrow=null,this.gainLabel=null,this.startingPoint={x:0,y:0},this.endingPoint={x:0,y:0},this.from=e,this.to=null,this._create(),this._addArrow()}return Object(W["a"])(t,[{key:"_create",value:function(){var t=document.getElementById("board"),e="http://www.w3.org/2000/svg",n=document.createElementNS(e,"path");this.startingPoint.x=this.from.center.x+this.from.width/2*16,this.startingPoint.y=this.from.center.y,this.endingPoint.x=this.from.center.x+this.from.width/2*16,this.endingPoint.y=this.from.center.y,this._updateBranchAttributes(n),t.appendChild(n),this.branch=n}},{key:"_updateBranchAttributes",value:function(t){var e=this.startingPoint.x,n=this.startingPoint.y,o=this.endingPoint.x,r=this.endingPoint.y;this.reversed=o<e;var i=.5*(o+e),s=.5*(r+n),a=Math.atan2(r-n,o-e)-Math.PI/2,c=o-e,u=c/2.5;e>o&&(u=c/2*-1),-40<=c&&c<=-35.2&&(u=3*c);var l=i+u*Math.cos(a),d=s+u*Math.sin(a),h="M".concat(e," ").concat(n," Q").concat(l," ").concat(d," ").concat(o," ").concat(r);R["a"].set(t,{attr:{d:h,stroke:"black","stroke-width":"2px",fill:"none"},css:{pointerEvents:"none"}})}},{key:"_addArrow",value:function(){var t=this,e=document.getElementById("board"),n="http://www.w3.org/2000/svg",o=document.createElementNS(n,"polygon");this._updateArrowAttributes(o),this.arrow=o,this.arrow.onmousedown=function(){t.setSelfAsSelected(),t.mouseDown=!0},this.arrow.onmouseup=function(){return t.mouseDown=!1},e.appendChild(o)}},{key:"_updateArrowAttributes",value:function(t){var e=Math.atan2(this.endingPoint.y-this.startingPoint.y,this.endingPoint.x-this.startingPoint.x),n=this.branch.getTotalLength(),o=this.branch.getPointAtLength(.5*n),r=o.x,i=o.y,s={x:r+8,y:i},a={x:r-8,y:i+8},c={x:r,y:i},u={x:r-8,y:i-8};s=this._rotatePoint(r,i,e,s),a=this._rotatePoint(r,i,e,a),u=this._rotatePoint(r,i,e,u),R["a"].set(t,{attr:{points:"".concat(s.x,",").concat(s.y," ").concat(a.x,",").concat(a.y," ").concat(c.x,",").concat(c.y," ").concat(u.x,",").concat(u.y),fill:"black"}})}},{key:"updateStartingPoint",value:function(){this.startingPoint.x=this.from.center.x+this.from.width/2*16,this.startingPoint.y=this.from.center.y,this._updateBranchAttributes(this.branch),this._updateArrowAttributes(this.arrow),null!=this.gainLabel&&this._updateGainLabelAttributes(this.gainLabel)}},{key:"updateEndingPoint",value:function(t,e){this.endingPoint.x=t,this.endingPoint.y=e,this._updateBranchAttributes(this.branch),this._updateArrowAttributes(this.arrow),null!=this.gainLabel&&this._updateGainLabelAttributes(this.gainLabel)}},{key:"updateEndingPointAuto",value:function(){this.updateEndingPoint(this.to.center.x-this.to.width/2*16,this.to.center.y)}},{key:"setToComponent",value:function(t){this.to=t;var e=t.center.x-t.width/2*16,n=t.center.y;this.updateEndingPoint(e,n)}},{key:"removeSelf",value:function(){this.branch.remove(),this.arrow.remove(),this.gainLabel.remove(),null!=this.to&&this.to.fromConnectionPoint.fromComponents.delete(this.from.code),this.from.toConnectionPoint.outConnectors.delete(this.code)}},{key:"cancelHooking",value:function(){this.branch.remove(),this.arrow.remove(),null!=this.to&&this.to.fromConnectionPoint.fromComponents.delete(this.from.code),this.from.toConnectionPoint.outConnectors.delete(this.code)}},{key:"addGainLabel",value:function(){var t=this,e=document.getElementById("board"),n="http://www.w3.org/2000/svg",o=document.createElementNS(n,"text");o.textContent="".concat(this.gain),this._updateGainLabelAttributes(o),this.gainLabel=o,this.gainLabel.ondblclick=function(){return t._updateGainValue()},e.appendChild(o)}},{key:"_updateGainLabelAttributes",value:function(t){var e=this.branch.getTotalLength(),n=this.branch.getPointAtLength(.5*e);R["a"].set(t,{attr:{x:n.x,y:n.y+20*(this.reversed?-1:1),"text-anchor":"middle",fill:"black","font-size":"medium",dy:"0.5rem",stroke:"black","stroke-width":"1px"},css:{userSelect:"none"}})}},{key:"_updateGainValue",value:function(){var t=1;do{t=parseInt(window.prompt("branch gain = ",10))}while(isNaN(t)||0==t);this.gain=t,null!=this.gainLabel&&(this.gainLabel.textContent="".concat(this.gain))}},{key:"remove",value:function(){this.removeSelf()}},{key:"_generateCode",value:function(){return t.codeCount++}},{key:"setSelfAsSelected",value:function(){var t=tt.getters.getCurrSelectedComponent;null!=t&&t.unselectSelf(),tt.commit("setCurrSelectedComponent",this),this._selectSelf()}},{key:"_selectSelf",value:function(){this.branch.setAttribute("stroke","rgb(30, 89, 202)"),this.arrow.setAttribute("fill","rgb(30, 89, 202)")}},{key:"highlightSelf",value:function(){this.branch.setAttribute("stroke","#E74C3C"),this.arrow.setAttribute("fill","#E74C3C")}},{key:"unselectSelf",value:function(){this.branch.setAttribute("stroke","black"),this.arrow.setAttribute("fill","black")}},{key:"_rotatePoint",value:function(t,e,n,o){var r=Math.sin(n),i=Math.cos(n);o.x-=t,o.y-=e;var s=o.x*i-o.y*r,a=o.x*r+o.y*i;return o.x=s+t,o.y=a+e,o}}]),t}();Object(G["a"])(it,"codeCount",1);var st=function(t){Object(et["a"])(n,t);var e=Object(nt["a"])(n);function n(t){var o;return Object(F["a"])(this,n),o=e.call(this,t),o.tempConnector=null,o.outConnectors=new Map,o._createConnectionWrapper(t.center.y+t.width/2*16),o._createConnectionPoint(t.center.x+t.width/2*16),o._addActions(),o}return Object(W["a"])(n,[{key:"deleteAll",value:function(){this.removeSelf();var t,e=Object(b["a"])(this.outConnectors.values());try{for(e.s();!(t=e.n()).done;){var n=t.value;n.removeSelf()}}catch(o){e.e(o)}finally{e.f()}this.outConnectors.clear()}},{key:"updatePos",value:function(){this.connectionPoint.setAttribute("cx",this.componentAttached.center.x+this.componentAttached.width/2*16),this.connectionPoint.setAttribute("cy",this.componentAttached.center.y),this.connectionPointWrapper.setAttribute("cx",this.componentAttached.center.x+this.componentAttached.width/2*16),this.connectionPointWrapper.setAttribute("cy",this.componentAttached.center.y)}},{key:"_addActions",value:function(){var t=this;this.connectionPoint.onmousedown=function(){t._addConnector()}}},{key:"reset",value:function(){this.removeSelf(),this._createConnectionWrapper(this.componentAttached.center.y+this.componentAttached.width/2*16),this._createConnectionPoint(this.componentAttached.center.x+this.componentAttached.width/2*16),this._addActions()}},{key:"_addConnector",value:function(){var t=this,e=document.getElementById("header").offsetHeight;this.tempConnector=new it(this.componentAttached),tt.dispatch("setFromComponent",this.componentAttached);var n=setInterval((function(){if(tt.getters.isBoardMouseDown){var o=window.mouseX,r=window.mouseY-e;t.tempConnector.updateEndingPoint(o,r)}else null==tt.getters.getToComponent?t._removeConnector():(t._hookConnector(),t._setGain()),clearInterval(n)}),10)}},{key:"_removeConnector",value:function(){null!=this.tempConnector&&(this.tempConnector.cancelHooking(),tt.dispatch("resetToComponent"))}},{key:"_hookConnector",value:function(){var t=tt.getters.getToComponent;t.fromConnectionPoint.hasFromComponent(this.componentAttached.code)?this._removeConnector():(this.tempConnector.setToComponent(t),t.fromConnectionPoint.addFromComponent(this.componentAttached),t.fromConnectionPoint.addInConnector(this.tempConnector),this.outConnectors.set(this.tempConnector.code,this.tempConnector),this.componentAttached.reset(),t.reset(),tt.dispatch("resetFromComponent"),tt.dispatch("resetToComponent"),this._resetAllMachines())}},{key:"_resetAllMachines",value:function(){var t,e=Object(b["a"])(tt.getters.nodes.values());try{for(e.s();!(t=e.n()).done;){var n=t.value;n.resetColor()}}catch(o){e.e(o)}finally{e.f()}}},{key:"_setGain",value:function(){var t=1;do{t=parseInt(window.prompt("branch gain = ",10))}while(isNaN(t)||0==t);this.tempConnector.gain=t,this.tempConnector.addGainLabel()}}]),n}(ot),at=function(){function t(e,n){Object(F["a"])(this,t),this.component=null,this.componentLabel=null,this.center={x:e,y:n},this.code=this._generateCode(),this.mouseDown=!1,this.isInputNode=!1,this.isOutputNode=!1,this.fromConnectionPoint=null,this.toConnectionPoint=null,this.fillColor="black",this._create(),this._addConnectionPoints(),this._addEventListeners()}return Object(W["a"])(t,[{key:"_create",value:function(){var t=document.getElementById("board"),e="http://www.w3.org/2000/svg",n=document.createElementNS(e,"circle");this.width=2.2,R["a"].set(n,{attr:{cx:this.center.x,cy:this.center.y,r:"1.1rem",fill:this.fillColor,stroke:this.fillColor,"stroke-width":"2px"}});var o=document.createElementNS(e,"text");o.textContent="".concat(this.code),R["a"].set(o,{attr:{x:this.center.x,y:this.center.y,"text-anchor":"middle",fill:"white","font-size":"medium",dy:"0.4rem"},css:{userSelect:"none",pointerEvents:"none"}}),t.appendChild(n),t.appendChild(o),this.component=n,this.componentLabel=o}},{key:"updatePos",value:function(t,e){this.updateCenter(t,e),this._updateConnectionPointsPos(),this.component.setAttribute("cx",this.center.x),this.component.setAttribute("cy",this.center.y),this.componentLabel.setAttribute("x",this.center.x),this.componentLabel.setAttribute("y",this.center.y)}},{key:"updateFillColor",value:function(t){this.fillColor=t,this.component.setAttribute("fill",t)}},{key:"resetColor",value:function(){this.fillColor="black",this.component.setAttribute("fill",this.fillColor)}},{key:"remove",value:function(){t.availableCodes.push(this.code),tt.getters.nodes.delete(this.code),this.removeSelf()}},{key:"_moveMouseDownHandling",value:function(){this.mouseDown=!0,this._trackMovement()}},{key:"_trackMovement",value:function(){var t=this,e=document.getElementById("header").offsetHeight,n=setInterval((function(){if(t.mouseDown&&t.mouseOnBoard()){var o=window.mouseX,r=window.mouseY-e;t.updatePos(o,r),t._updateConnectorsPos()}else clearInterval(n)}),10)}},{key:"_addEventListeners",value:function(){var t=this;this.component.onmousedown=function(){t._moveMouseDownHandling(),t.setSelfAsSelected()},this.component.onmouseup=function(){return t._moveMouseUpHandling()}}},{key:"_generateCode",value:function(){return t.availableCodes.length>0?t.availableCodes.pop():t.codeCount++}},{key:"updateCenter",value:function(t,e){this.center.x=t,this.center.y=e}},{key:"removeSelf",value:function(){this.component.remove(),this.componentLabel.remove(),this.fromConnectionPoint.deleteAll(),this.toConnectionPoint.deleteAll()}},{key:"_moveMouseUpHandling",value:function(){this.mouseDown=!1}},{key:"mouseOnBoard",value:function(){return document.getElementById("board").matches(":hover")}},{key:"_addConnectionPoints",value:function(){this.fromConnectionPoint=new rt(this),this.toConnectionPoint=new st(this)}},{key:"_updateConnectionPointsPos",value:function(){this.fromConnectionPoint.updatePos(),this.toConnectionPoint.updatePos()}},{key:"_updateConnectorsPos",value:function(){var t,e=Object(b["a"])(this.fromConnectionPoint.inConnectors.values());try{for(e.s();!(t=e.n()).done;){var n=t.value;n.updateEndingPointAuto()}}catch(s){e.e(s)}finally{e.f()}var o,r=Object(b["a"])(this.toConnectionPoint.outConnectors.values());try{for(r.s();!(o=r.n()).done;){var i=o.value;i.updateStartingPoint()}}catch(s){r.e(s)}finally{r.f()}}},{key:"resetConnectionPoints",value:function(){this.fromConnectionPoint.reset(),this.toConnectionPoint.reset()}},{key:"setSelfAsSelected",value:function(){var t=tt.getters.getCurrSelectedComponent;null!=t&&t.unselectSelf(),tt.commit("setCurrSelectedComponent",this),this._selectSelf()}},{key:"_selectSelf",value:function(){this.component.setAttribute("fill","rgb(30, 89, 202)")}},{key:"unselectSelf",value:function(){this.component.setAttribute("fill",this.fillColor),this.component.setAttribute("stroke",this.fillColor)}},{key:"highlightSelf",value:function(){this.component.setAttribute("fill","#E74C3C"),this.component.setAttribute("stroke","#E74C3C")}},{key:"reset",value:function(){this.component.remove(),this.componentLabel.remove(),this._create(),this._addEventListeners(),this.resetConnectionPoints()}}]),t}();Object(G["a"])(at,"codeCount",1),Object(G["a"])(at,"availableCodes",[]);var ct={name:"clearAll",data:function(){return{}},computed:Object(d["c"])(["nodes"]),methods:Object(l["a"])(Object(l["a"])({},Object(d["b"])(["resetCurrSelectedComponent"])),{},{clearAll:function(){var t,e=Object(b["a"])(this.nodes.values());try{for(e.s();!(t=e.n()).done;){var n=t.value;n.remove()}}catch(o){e.e(o)}finally{e.f()}at.codeCount=1,at.availableCodes.length=0,this.resetCurrSelectedComponent()}})},ut=ct,lt=(n("9879"),Object(f["a"])(ut,T,H,!1,null,null,null)),dt=lt.exports,ht={name:"appHeader",components:{insert:v,solve:B,clearAll:dt}},mt=ht,ft=(n("2b45"),Object(f["a"])(mt,s,a,!1,null,"000cc56e",null)),pt=ft.exports,vt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("svg",{attrs:{id:"board",width:t.boardProbs.width,height:t.boardProbs.height,version:"1.1",xmlns:"http://www.w3.org/2000/svg"},on:{mouseover:function(e){return t.mouseOverHandling()},mousedown:function(e){return t.mouseDownHandling()},mouseup:function(e){return t.mouseUpHandling()}}})},gt=[],Ct=function(t){Object(et["a"])(n,t);var e=Object(nt["a"])(n);function n(t,o){var r;return Object(F["a"])(this,n),r=e.call(this,t,o),r.isInputNode=!0,r.componentLabel.textContent="R",at.availableCodes.push(r.code),r.code="R",r.setupInputNode(),r}return Object(W["a"])(n,[{key:"setupInputNode",value:function(){this.fromConnectionPoint.removeSelf()}},{key:"remove",value:function(){}},{key:"resetConnectionPoints",value:function(){this.toConnectionPoint.reset()}}]),n}(at),bt=function(t){Object(et["a"])(n,t);var e=Object(nt["a"])(n);function n(t,o){var r;return Object(F["a"])(this,n),r=e.call(this,t,o),r.isOutputNode=!0,r.componentLabel.textContent="C",at.availableCodes.push(r.code),r.code="C",r.setupOuputNode(),r}return Object(W["a"])(n,[{key:"setupOuputNode",value:function(){this.toConnectionPoint.removeSelf()}},{key:"remove",value:function(){}},{key:"resetConnectionPoints",value:function(){this.fromConnectionPoint.reset()}}]),n}(at),yt={name:"board",data:function(){return{boardProbs:{width:100,height:100},components:{node:"machine"},currentComponent:{component:null,startingPos:{x:0,y:0}},mousePointer:{originX:0,originY:0,x:0,y:0,updatePosition:function(){this.x=window.mouseX-this.originX,this.y=window.mouseY-this.originY}}}},computed:Object(d["c"])(["isDrawing","getCurrentComponent","getCurrSelectedComponent","nodes"]),methods:Object(l["a"])(Object(l["a"])({},Object(d["b"])(["disableDrawingMode","pushNewNode","setCurrentComponent","setBoardMouseDown"])),{},{mouseOverHandling:function(){var t=this,e=setInterval((function(){if(t.isDrawing&&t.mouseOnBoard()){t.mousePointer.updatePosition(),null==t.getCurrentComponent&&(t.setStartingPos(),t.createComponent(),t.setCurrentComponent(t.currentComponent.component));var n=t.mousePointer.x,o=t.mousePointer.y;t.currentComponent.component.updatePos(n,o)}else clearInterval(e)}),10)},mouseDownHandling:function(){this.setBoardMouseDown(!0);var t=this.getCurrSelectedComponent;null==t||t.mouseDown||t.unselectSelf(),this.resetAllNodes(),null!=this.getCurrentComponent&&this.isDrawing&&(this.pushNewNode(this.currentComponent.component),this.disableDrawingMode(),this.setCurrentComponent(null))},mouseUpHandling:function(){this.setBoardMouseDown(!1)},createComponent:function(){this.currentComponent.component=new at(this.currentComponent.startingPos.x,this.currentComponent.startingPos.y)},setStartingPos:function(){this.currentComponent.startingPos.x=this.mousePointer.x,this.currentComponent.startingPos.y=this.mousePointer.y},mouseOnBoard:function(){return this.board.matches(":hover")},resetAllNodes:function(){},mountInputNode:function(){var t=70,e=this.boardProbs.height/2,n=new Ct(t,e);this.pushNewNode(n)},mountOutputNode:function(){var t=this.boardProbs.width-70,e=this.boardProbs.height/2,n=new bt(t,e);this.pushNewNode(n)}}),mounted:function(){this.board=document.getElementById("board"),this.boardProbs.width=window.innerWidth;var t=document.getElementById("header").offsetHeight;this.mousePointer.originY=t,this.boardProbs.height=window.innerHeight-t,this.mountInputNode(),this.mountOutputNode(),document.onmousemove=function(t){var e=t||window.event;window.mouseX=e.clientX,window.mouseY=e.clientY}}},wt=yt,Pt=(n("e251"),Object(f["a"])(wt,vt,gt,!1,null,"2020be00",null)),_t=Pt.exports,At=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"hidden",attrs:{id:"error-msg"}},[n("div",{attrs:{id:"label"}},[t._v("!")]),n("div",{attrs:{id:"msg"}},[t._v(t._s(t.getErrorMsg))])])},kt=[],xt={name:"errorMsg",data:function(){return{}},computed:Object(d["c"])(["getErrorMsg","getErrorCard"]),methods:Object(l["a"])(Object(l["a"])({},Object(d["b"])(["setErrorCard"])),{},{showErrorMsg:function(){var t=this,e=document.getElementById("error-msg");e.className="visible",setTimeout((function(){return t.hideErrorMsg()}),4e3)},hideErrorMsg:function(){var t=document.getElementById("error-msg");t.className="hidden"}}),mounted:function(){this.setErrorCard(this)}},Ot=xt,St=(n("5355"),Object(f["a"])(Ot,At,kt,!1,null,"93c79c58",null)),Et=St.exports,Mt=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"side-area",attrs:{id:"solution-area"}},[o("div",{attrs:{id:"solve-header"}},[o("div",{attrs:{id:"solve-label"}},[t._v("Solution")]),o("div",{attrs:{id:"solve-close-btn"},on:{click:function(e){return t.close()}}},[o("img",{attrs:{src:n("fc48"),width:"16px"}})])]),o("div",{attrs:{id:"steps"}})])},jt=[],Nt={name:"solutionArea",data:function(){return{closedMenu:!0}},methods:{open:function(){this.closedMenu&&(document.getElementById("solution-area").style.width="40rem",document.getElementById("sketching-area").style.marginRight="40rem",this.closedMenu=!1)},close:function(){document.getElementById("solution-area").style.width="0rem",document.getElementById("sketching-area").style.marginRight="0rem",document.getElementById("board").style.transform="scale(1)",document.getElementById("board").style.left="0",document.getElementById("board").style.pointerEvents="auto",this.closedMenu=!0}},created:function(){this.$root.$refs.solutionArea=this}},It=Nt,Lt=(n("c8b6"),Object(f["a"])(It,Mt,jt,!1,null,"6bbf5128",null)),Dt=Lt.exports,$t={name:"App",components:{appHeader:pt,board:_t,errorMsg:Et,solutionArea:Dt}},Bt=$t,Tt=(n("034f"),Object(f["a"])(Bt,r,i,!1,null,null,null)),Ht=Tt.exports;o["a"].config.productionTip=!1,new o["a"]({store:tt,render:function(t){return t(Ht)}}).$mount("#app")},6352:function(t,e,n){},"85ec":function(t,e,n){},"885c":function(t,e,n){t.exports=n.p+"img/cursor.d9ce2e74.png"},"945f":function(t,e,n){},9879:function(t,e,n){"use strict";n("945f")},c82a:function(t,e,n){},c8b6:function(t,e,n){"use strict";n("6352")},d004:function(t,e,n){"use strict";n("184d")},dd77:function(t,e,n){},e251:function(t,e,n){"use strict";n("0d1f")},ec4c:function(t,e,n){},fc48:function(t,e,n){t.exports=n.p+"img/delete.129e5d3b.png"}});
//# sourceMappingURL=app.a65b8c62.js.map